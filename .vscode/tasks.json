{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Import Module",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-Command",
                "Import-Module ./src/ADScout/ADScout.psd1 -Force -Verbose"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "Run Tests",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-Command",
                "Invoke-Pester ./tests -Output Detailed"
            ],
            "group": {
                "kind": "test",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "Run Tests with Coverage",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-Command",
                "$config = New-PesterConfiguration; $config.Run.Path = './tests'; $config.Output.Verbosity = 'Detailed'; $config.CodeCoverage.Enabled = $true; $config.CodeCoverage.Path = './src'; Invoke-Pester -Configuration $config"
            ],
            "group": "test",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "Run PSScriptAnalyzer",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-Command",
                "Invoke-ScriptAnalyzer -Path ./src -Recurse -Settings ./.psscriptanalyzerrc | Format-Table -AutoSize"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "Build Module",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-File",
                "./build/Build-Module.ps1"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "Generate Documentation",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-File",
                "./build/Update-Documentation.ps1"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "Create New Rule",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-NoProfile",
                "-Command",
                "Import-Module ./src/ADScout/ADScout.psd1 -Force; New-ADScoutRule -Name '${input:ruleName}' -Category '${input:ruleCategory}'"
            ],
            "group": "none",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        }
    ],
    "inputs": [
        {
            "id": "ruleName",
            "type": "promptString",
            "description": "Enter the rule name (e.g., WeakPassword)"
        },
        {
            "id": "ruleCategory",
            "type": "pickString",
            "description": "Select rule category",
            "options": [
                "Anomalies",
                "StaleObjects",
                "PrivilegedAccounts",
                "Trusts"
            ]
        }
    ]
}
